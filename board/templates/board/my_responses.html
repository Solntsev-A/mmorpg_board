{% extends 'base.html' %}

{% block content %}
<h1>Отклики на мои объявления</h1>

<form method="get" class="mb-4">
    <label for="advertisement" class="form-label">
        Фильтр по объявлению
    </label>

    <select name="advertisement"
            id="advertisement"
            class="form-select"
            onchange="this.form.submit()">

        <option value="">Все объявления</option>

        {% for ad in advertisements %}
            <option value="{{ ad.id }}"
                {% if selected_advertisement == ad.id|stringformat:"s" %}
                    selected
                {% endif %}
            >
                {{ ad.title }}
            </option>
        {% endfor %}
    </select>
</form>
{% if responses %}
    <ul class="list-group">
        {% for response in responses %}
            <li class="list-group-item mb-2">
                <strong>{{ response.advertisement.title }}</strong><br>
                От: {{ response.author.email }}<br>
                {{ response.text }}<br>
                {% if response.is_accepted %}
                    <span class="badge bg-success">Принят</span>
                {% else %}
                    <span class="badge bg-secondary">Ожидает</span>
                    <form method="post"
                          action="{% url 'board:accept_response' response.pk %}"
                          style="display:inline;">
                        {% csrf_token %}
                        <button type="submit" class="btn btn-sm btn-outline-success">
                            Принять
                        </button>
                    </form>
                {% endif %}
                <form method="post"
                      action="{% url 'board:delete_response' response.pk %}"
                      style="display:inline;">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-sm btn-outline-danger">
                        Удалить
                    </button>
                </form>
            </li>
            <hr>
        {% endfor %}
    </ul>
{% else %}
    <p>Откликов пока нет.</p>
{% endif %}
{% endblock %}
