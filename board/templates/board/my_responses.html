{% extends 'base.html' %}

{% block content %}
<h1>Отклики на мои объявления</h1>

<form method="get" class="mb-4">
    <label for="advertisement" class="form-label">
        Фильтр по объявлению
    </label>

    <select name="advertisement"
            id="advertisement"
            class="form-select"
            onchange="this.form.submit()">

        <option value="">Все объявления</option>

        {% for ad in advertisements %}
            <option value="{{ ad.id }}"
                {% if selected_advertisement == ad.id|stringformat:"s" %}
                    selected
                {% endif %}
            >
                {{ ad.title }}
            </option>
        {% endfor %}
    </select>
</form>

{% if responses %}
    <ul>
        {% for response in responses %}
            <li>
                <strong>{{ response.advertisement.title }}</strong><br>
                От: {{ response.author.email }}<br>
                {{ response.text }}<br>

                {% if response.is_accepted %}
                    <span style="color: green;">Принят</span>
                {% else %}
                    <form method="post" action="{% url 'board:accept_response' response.pk %}" style="display:inline;">
                        {% csrf_token %}
                        <button type="submit">Принять</button>
                    </form>
                {% endif %}

                <form method="post" action="{% url 'board:delete_response' response.pk %}" style="display:inline;">
                    {% csrf_token %}
                    <button type="submit">Удалить</button>
                </form>
            </li>
            <hr>
        {% endfor %}
    </ul>
{% else %}
    <p>Откликов пока нет.</p>
{% endif %}
{% endblock %}
